{% extends "layouts.list-sidebar" %}

{% block title %}Manage courses units{% endblock %}

{% block sidebar %}
  <div class="well">
    <h4 class="page-title-no-top">Filter list by:</h4>
    {% autoescape false %}
    {{ form_open({'route': 'admin.units.index', 'method': 'get'}) }}
    <div class="form-group">
      {{ form_label('search', 'Search for a unit', {'id': 'search-label', 'class': 'form-label'}) }}
      <div class="input-group">
        {{ form_input('search', 'search', input_get('search'), {'id': 'search', 'class': 'form-control', 'placeholder': 'Search'}) }}
        <span class="input-group-btn">
          <button class="btn btn-default" type="button">
            <span class="glyphicon glyphicon-search"></span>
          </button>
        </span>
      </div>
    </div>

    <div class="form-group">
      {{ form_label('subjectsector', 'Filter by subject sector', {'id': 'subject-label', 'class': 'form-label'}) }}
      {{ form_select('subjectsector', subjectSectorsForm,
      input_get('subjectsector'), {'id': 'subject-sector', 'class': 'form-control chosen-select', 'onchange': 'this.form.submit()'}) }}
    </div>
    {{ form_close() }}
    <a href="{{ route('admin.units.index') }}">Reset all fields</a>
    {% endautoescape %}

    <hr>

    <a href="{{ route('admin.units.create') }}" class="btn btn-primary"><span class="octicon octicon-plus"></span>
      Create a new unit</a>

  </div>
{% endblock %}

{% block content %}
  <header>
    <ol class="breadcrumb">
      <li><a href="{{ route('home') }}">Home</a></li>
      <li class="active">Units</li>
    </ol>
    {% if session_has('successMessage') %}
      <div class="alert alert-success">
        {{ session_get('successMessage') }}
      </div>
    {% endif %}

    {% if session_has('infoMessage') %}
      <div class="alert alert-info">
        {{ session_get('infoMessage') }}
      </div>
    {% endif %}

    {% if session_has('errorMessage') %}
      <div class="alert alert-danger">
        {{ session_get('errorMessage') }}
      </div>
    {% endif %}

    <h1 class="page-header">Manage course units</h1>
  </header>

  <article>
    <table class="table table-borders table-responsive">
      <thead>
      <tr>
        <th>Unit Code</th>
        <th>Unit number</th>
        <th>Unit name</th>
        <th>Credit value</th>
        <th>GLH</th>
        <th>Level</th>
        <th>Subject sector</th>
        <th></th>
      </tr>
      </thead>

      <tbody>
      {% for unit in units %}
        <tr>
          <td><a href="{{ route('admin.units.show', unit.id) }}">{{ unit.id }}</a></td>
          <td><a href="{{ route('admin.units.show', unit.id) }}">{{ unit.number }}</a></td>
          <td><a href="{{ route('admin.units.show', unit.id) }}">{{ unit.name }}</a></td>
          <td>{{ unit.credit_value }}</td>
          <td>{{ unit.glh }}</td>
          <td>{{ unit.level }}</td>
          <td>{{ unit.subject_sector_name }}</td>
          <td>
            <a href="{{ route('admin.units.delete_confirm', unit.id) }}" data-toggle="modal" data-target="#web-modal"
               class="btn btn-danger btn-sm">Delete</a>
          </td>
        </tr>
      {% else %}
        <tr>
          <td colspan="5">No course units have been found.</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>

    <div class="text-center">
      {% autoescape false %}
      {{ units.appends({'search': input_get('search'), 'subjectsector': input_get('subjectsector')}).links() }}
      {% endautoescape %}
    </div>
  </article>
{% endblock %}
