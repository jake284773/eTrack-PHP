{% extends "layouts.transaction" %}

{% block title %}Batch import of user accounts{% endblock %}
{% block mainclass %}col-md-8 col-md-offset-1{% endblock %}

{% block content %}
  <header class="page-header section-heading">
    <hgroup>
      <h2>
          <span class="section-marker">Step 3 of 3</span>
          <span class="section-title">Confirm and Print</span>
      </h2>
    </hgroup>
  </header>

  <article>
    <div class="row">
      <div class="col-md-9">
        {% if session_has('errorMessage') %}
          <div class="alert alert-danger">
            {{ session_get('errorMessage') }}
          </div>
        {% endif %}

        {% if session_has('infoMessage') %}
          <div class="alert alert-info">
            {{ session_get('infoMessage') }}
          </div>
        {% endif %}

        <div class="alert alert-success">
          <h4>Batch import complete!</h4>
        </div>

        <div class="alert alert-info">
          If you want a printable version of each user's ID and password that can
          be given to the new user, click the <strong>Print out</strong> button.
        </div>
      </div>
    </div>

    <h4>Imported records:</h4>

    <table class="table table-responsive table-bordered">
      <thead>
        <tr>
          <th>User ID</th>
          <th>Email address</th>
          <th>Password (generated)</th>
          <th>Full name</th>
          <th>User role</th>
        </tr>
      </thead>

      <tbody>
        {% for user in users %}
          <tr>
            <td>{{ user['id'] }}</td>
            <td>{{ user['email'] }}</td>
            <td>{{ user['password'] }}</td>
            <td>{{ user['full_name'] }}</td>
            <td>{{ user['role'] }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="well">
      {% autoescape false %}
        {{ form_open() }}
          {{ form_button('Back to Users list', {'class': 'btn btn-primary', 'name': 'submit', 'value': 'complete', 'type': 'submit'}) }}
          <a href="{{ route('admin.users.import.print') }}" class="btn btn-danger" target="_blank">Print-out</a>
        {{ form_close() }}
      {% endautoescape %}
    </div>
  </div>
</article>
{% endblock %}

{% block transactionsteps %}
  <li>Data upload</li>
  <li>Check processed data</li>
  <li class="active">Confirm and Print</li>
{% endblock %}